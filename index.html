

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <link rel="shortcut icon" type="imagex/png" href="https://i.imgur.com/9A9knkK.png">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ENM - Cálculo de Impostos para Entrada de DI</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dark-mode.css" id="dark-mode-stylesheet">
    <style>
    /* Estilo da calculadora */
    .calculator {
        position: fixed;
        bottom: 20px;
     color: black;
        left: 20px;
        border: 2px solid #ccc;
        padding: 15px;
        border-radius: 10px;
        background-color: #fff;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        width: 230px; /* Ajuste de largura */
        display: none; /* Inicialmente oculta */
    }
    .calculator-screen {
        width: 100%;
        height: 60px; /* Aumenta a altura do display */
        background-color: #f4f4f4;
        border: 1px solid #ddd;
        border-radius: 5px;
        margin-bottom: 10px;
        text-align: right;
        padding: 10px;
        font-size: 28px; /* Aumenta o tamanho da fonte */
        overflow: hidden;
        box-sizing: border-box; /* Inclui padding e bordas na largura total */
    }
    .calculator-buttons {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 5px;
    }
    .calculator-button {
        width: 100%;
        height: 60px; /* Alinha a altura dos botões com o display */
        display: flex;
color: black;
        align-items: center;
        justify-content: center;
        font-size: 24px; /* Ajusta o tamanho da fonte dos botões */
        background-color: #e0e0e0;
        border: 1px solid #ccc;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.2s, transform 0.2s;
    }
    .calculator-button:hover {
        background-color: #d0d0d0;
    }
    .calculator-button:active {
        transform: scale(0.98);
    }
    .calculator-button.operator {
        background-color: #fe9241;
        color: black;
    }
    .calculator-button.double {
        grid-column: span 2;
    }
    .calculator-button.double-operator {
        grid-column: span 4;
    }

    /* Estilo do botão de abrir/fechar calculadora */
    .toggle-calculator {
        position: fixed;
        bottom: 20px;
        left: 20px;
        background-color: #fe9241;
        color: black;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        transition: background-color 0.2s;
    }
    .toggle-calculator:hover {
        background-color: #e07b34;
    }
</style>
</head>
<body>

<div class="imagens">
    <img src="https://i.imgur.com/O7MOBCK.png" />
</div>

<div class="container">
    <h1 class="titulopg animate-text">Cálculo de Impostos - Entrada de DI</h1>
    <form id="entradaDIForm">
        <label for="valorPIS" class="animate-text"> <b> Valor total PIS: </b> </label>
        <input type="text" id="valorPIS" placeholder="Ex.: 12.500,50 ou 12500,50 (com vírgula)" required>
        
        <label for="valorCOFINS" class="animate-text"> <b> Valor total COFINS: </b> </label>
        <input type="text" id="valorCOFINS" placeholder="Ex.: 30.100,50 ou 30100,50 (com vírgula)" required>
        
        <label for="valorSISCOMEX" class="animate-text"> <b> Valor total SISCOMEX: </b> </label>
        <input type="text" id="valorSISCOMEX" placeholder="Ex.: 500 ou 500,00 (com vírgula)" required>
        
        <label for="valorNumerario" class="animate-text"> <b> Valor total NUMERARIO: </b> </label>
        <input type="text" id="valorNumerario" placeholder="Ex.: 1.300,50 ou 1300,50 (com vírgula)" required>

        <label for="valorVariacao" class="animate-text"> <b> Valor total VARIAÇÃO: </b> </label>
        <input type="text" id="valorVariacao" placeholder="Ex.: 1.100,50 ou 1100,50 (com vírgula)" required>

        
        <label for="quantidadeFornecedores" class="animate-text"> <b> Quantidade de fornecedores: </b> </label>
        <select id="quantidadeFornecedores" class="animate-text">
            <option value="0">Selecione</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
        </select>
        
        <div id="fornecedoresFields" style="display: none;">

        </div>
        
        <button type="button" id="calcularbotao" onclick="calcularValores()" class="animate-text">Concluir</button>
        <button type="button" id="limparbotao" onclick="limparCampos()" class="animate-text">Limpar</button>
        <button type="button" id="exportarExcelButton" onclick="exportarParaExcel()" style="display: none;" class="animate-text">Exportar para Microsoft Excel</button>
    </form>
    <div id="resultado"></div>
</div>

<div class="botao-modo-escuro">
  <button class="modo-escuro-btn" onclick="alternarModo()">Modo Escuro</button>
</div>

<button type="button" id="recuperarCalculoBtn" onclick="exibirModal()">Último cálculo realizado</button>
<button type="button" id="sobreBtn" onclick="exibirModalSobre()">Sobre</button>

<div id="modal" class="modal">
  <div class="modal-content">
    <span class="close" onclick="fecharModal()">&times;</span>
    <p> <b> Último cálculo realizado: </b> </p>
    <div id="resultadoAnterior"></div>
  </div>
</div>

<div id="modalSobre" class="modal">
  <div class="modal-content">
    <span class="close" onclick="fecharModalSobre()">&times;</span>
    <p>Última atualização: 02/02/2024 </p>
  </div>
</div>

    <!-- Calculadora -->
<div class="calculator" id="calculator">
    <div class="calculator-screen" id="calculator-screen">0</div>
    <div class="calculator-buttons">
        <div class="calculator-button" onclick="appendNumber('7')">7</div>
        <div class="calculator-button" onclick="appendNumber('8')">8</div>
        <div class="calculator-button" onclick="appendNumber('9')">9</div>
        <div class="calculator-button operator" onclick="setOperator('/')">/</div>
        <div class="calculator-button" onclick="appendNumber('4')">4</div>
        <div class="calculator-button" onclick="appendNumber('5')">5</div>
        <div class="calculator-button" onclick="appendNumber('6')">6</div>
        <div class="calculator-button operator" onclick="setOperator('*')">*</div>
        <div class="calculator-button" onclick="appendNumber('1')">1</div>
        <div class="calculator-button" onclick="appendNumber('2')">2</div>
        <div class="calculator-button" onclick="appendNumber('3')">3</div>
        <div class="calculator-button operator" onclick="setOperator('-')">-</div>
        <div class="calculator-button double" onclick="appendNumber('0')">0</div>
        <div class="calculator-button" onclick="appendNumber('.')">.</div>
        <div class="calculator-button operator" onclick="setOperator('+')">+</div>
        <div class="calculator-button double-operator" onclick="calculateResult()">=</div>
        <div class="calculator-button double-operator" onclick="clearScreen()">C</div>
    </div>
</div>

<!-- Botão de abrir/fechar calculadora -->
<button class="toggle-calculator" onclick="toggleCalculator()">&#x1F522;</button> <!-- Ícone de calculadora -->

<script>
    let currentInput = '';
    let operator = null;
    let firstOperand = null;

    function appendNumber(number) {
        if (currentInput === '0' && number !== '.') {
            currentInput = number;
        } else {
            currentInput += number;
        }
        updateScreen();
    }

    function setOperator(op) {
        if (operator !== null) {
            calculateResult();
        }
        firstOperand = parseFloat(currentInput);
        operator = op;
        currentInput = '';
    }

    function calculateResult() {
        if (operator === null || currentInput === '') return;
        const secondOperand = parseFloat(currentInput);
        let result;
        switch (operator) {
            case '+':
                result = firstOperand + secondOperand;
                break;
            case '-':
                result = firstOperand - secondOperand;
                break;
            case '*':
                result = firstOperand * secondOperand;
                break;
            case '/':
                result = firstOperand / secondOperand;
                break;
            default:
                return;
        }
        currentInput = result.toString();
        operator = null;
        firstOperand = null;
        updateScreen();
    }

    function clearScreen() {
        currentInput = '';
        operator = null;
        firstOperand = null;
        updateScreen();
    }

    function updateScreen() {
        document.getElementById('calculator-screen').innerText = currentInput || '0';
    }

    function toggleCalculator() {
        const calculator = document.getElementById('calculator');
        const isVisible = calculator.style.display === 'block';
        calculator.style.display = isVisible ? 'none' : 'block';
    }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx-style/0.12.13/dist/xlsx.full.min.js"></script>
<script src="script.js"></script>
</body>
</html>
